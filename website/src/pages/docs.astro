---
import Layout from '../layouts/Layout.astro'
---

<Layout title="How to Use ASH" description="Step-by-step guide to setting up and using ASH for secure messaging.">
  <div class="py-16 sm:py-24">
    <!-- Header -->
    <div class="text-center mb-16">
      <span class="inline-block px-4 py-1.5 bg-brand-subtle text-brand-light text-xs font-semibold uppercase tracking-wider rounded-full mb-6">
        Documentation
      </span>
      <h1 class="text-4xl sm:text-5xl font-bold mb-4">How to Use ASH</h1>
      <p class="text-text-secondary text-lg max-w-2xl mx-auto">
        A step-by-step guide to setting up and using ASH for secure communication.
      </p>
    </div>

    <!-- Quick Navigation -->
    <div class="bg-bg-card border border-border rounded-xl p-6 mb-16">
      <h3 class="font-semibold mb-4">On This Page</h3>
      <div class="grid sm:grid-cols-2 md:grid-cols-4 gap-4 text-sm">
        <a href="#before-you-start" class="text-brand hover:text-brand-light">1. Before You Start</a>
        <a href="#the-ceremony" class="text-brand hover:text-brand-light">2. The Ceremony</a>
        <a href="#sending-messages" class="text-brand hover:text-brand-light">3. Sending Messages</a>
        <a href="#burning" class="text-brand hover:text-brand-light">4. Burning Conversations</a>
      </div>
    </div>

    <!-- Before You Start -->
    <section id="before-you-start" class="mb-16 scroll-mt-24">
      <h2 class="text-2xl font-bold mb-4 pb-2 border-b border-border">1. Before You Start</h2>

      <p class="text-text-secondary mb-6">
        ASH works differently from other messaging apps. Make sure you understand these requirements before beginning.
      </p>

      <div class="bg-bg-card border border-border rounded-xl p-6 mb-6">
        <h3 class="font-semibold mb-4">What You'll Need</h3>
        <ul class="space-y-3">
          <li class="flex items-start gap-3">
            <div class="w-6 h-6 rounded-full bg-brand flex items-center justify-center flex-shrink-0 mt-0.5">
              <svg class="w-4 h-4 text-white" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2">
                <path stroke-linecap="round" stroke-linejoin="round" d="M5 13l4 4L19 7" />
              </svg>
            </div>
            <div>
              <span class="font-medium">Two iPhones</span>
              <p class="text-text-muted text-sm">Both you and your contact need iOS devices with ASH installed</p>
            </div>
          </li>
          <li class="flex items-start gap-3">
            <div class="w-6 h-6 rounded-full bg-brand flex items-center justify-center flex-shrink-0 mt-0.5">
              <svg class="w-4 h-4 text-white" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2">
                <path stroke-linecap="round" stroke-linejoin="round" d="M5 13l4 4L19 7" />
              </svg>
            </div>
            <div>
              <span class="font-medium">In-person meeting</span>
              <p class="text-text-muted text-sm">You must be physically together to set up the connection</p>
            </div>
          </li>
          <li class="flex items-start gap-3">
            <div class="w-6 h-6 rounded-full bg-brand flex items-center justify-center flex-shrink-0 mt-0.5">
              <svg class="w-4 h-4 text-white" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2">
                <path stroke-linecap="round" stroke-linejoin="round" d="M5 13l4 4L19 7" />
              </svg>
            </div>
            <div>
              <span class="font-medium">Private location</span>
              <p class="text-text-muted text-sm">No cameras, no mirrors, no one watching your screens</p>
            </div>
          </li>
          <li class="flex items-start gap-3">
            <div class="w-6 h-6 rounded-full bg-brand flex items-center justify-center flex-shrink-0 mt-0.5">
              <svg class="w-4 h-4 text-white" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2">
                <path stroke-linecap="round" stroke-linejoin="round" d="M5 13l4 4L19 7" />
              </svg>
            </div>
            <div>
              <span class="font-medium">A shared passphrase</span>
              <p class="text-text-muted text-sm">Agree on a passphrase verbally — don't text or email it</p>
            </div>
          </li>
        </ul>
      </div>

      <div class="bg-warning/10 border border-warning/30 rounded-xl p-6">
        <h4 class="text-warning font-semibold mb-2 flex items-center gap-2">
          <svg class="w-5 h-5" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2">
            <path stroke-linecap="round" stroke-linejoin="round" d="M12 9v3.75m-9.303 3.376c-.866 1.5.217 3.374 1.948 3.374h14.71c1.73 0 2.813-1.874 1.948-3.374L13.949 3.378c-.866-1.5-3.032-1.5-3.898 0L2.697 16.126zM12 15.75h.007v.008H12v-.008z" />
          </svg>
          Important
        </h4>
        <p class="text-text-secondary text-sm">
          The in-person requirement is not optional — it's what makes ASH secure. If you share the passphrase or show QR codes over the internet, you lose the security guarantee.
        </p>
      </div>
    </section>

    <!-- The Ceremony -->
    <section id="the-ceremony" class="mb-16 scroll-mt-24">
      <h2 class="text-2xl font-bold mb-4 pb-2 border-b border-border">2. The Ceremony</h2>

      <p class="text-text-secondary mb-6">
        The "ceremony" is how you and your contact create a shared encryption key. It takes about 30-60 seconds once you know the process.
      </p>

      <!-- Choosing a Pad Size -->
      <div class="bg-bg-card border border-border rounded-xl p-6 mb-6">
        <h3 class="font-semibold mb-4">Step 1: Choose a Pad Size</h3>
        <p class="text-text-secondary text-sm mb-4">
          One person (the "initiator") starts by selecting how much key material to create. Larger pads allow more messages but take longer to transfer:
        </p>
        <div class="grid sm:grid-cols-3 gap-4">
          <div class="bg-bg-elevated rounded-lg p-4">
            <div class="text-2xl font-bold text-brand mb-1">64 KB</div>
            <div class="text-text-muted text-sm">~25 messages</div>
            <div class="text-text-muted text-xs mt-2">Quick ceremony, short conversations</div>
          </div>
          <div class="bg-bg-elevated rounded-lg p-4 border border-brand/30">
            <div class="text-2xl font-bold text-brand mb-1">256 KB</div>
            <div class="text-text-muted text-sm">~200 messages</div>
            <div class="text-text-muted text-xs mt-2">Recommended for most use cases</div>
          </div>
          <div class="bg-bg-elevated rounded-lg p-4">
            <div class="text-2xl font-bold text-brand mb-1">1 MB</div>
            <div class="text-text-muted text-sm">~800 messages</div>
            <div class="text-text-muted text-xs mt-2">Long-term communication</div>
          </div>
        </div>
      </div>

      <!-- QR Code Exchange -->
      <div class="bg-bg-card border border-border rounded-xl p-6 mb-6">
        <h3 class="font-semibold mb-4">Step 2: Exchange QR Codes</h3>
        <p class="text-text-secondary text-sm mb-4">
          Both phones will display animated QR codes. Point your camera at your partner's screen and let them point at yours.
        </p>
        <div class="grid md:grid-cols-2 gap-6">
          <div>
            <h4 class="text-sm font-medium text-text-muted mb-2">Initiator (Person A)</h4>
            <ol class="space-y-2 text-sm text-text-secondary">
              <li class="flex items-start gap-2">
                <span class="w-5 h-5 rounded-full bg-brand text-white text-xs flex items-center justify-center flex-shrink-0 mt-0.5">1</span>
                <span>Tap "Start Ceremony"</span>
              </li>
              <li class="flex items-start gap-2">
                <span class="w-5 h-5 rounded-full bg-brand text-white text-xs flex items-center justify-center flex-shrink-0 mt-0.5">2</span>
                <span>Enter the agreed passphrase</span>
              </li>
              <li class="flex items-start gap-2">
                <span class="w-5 h-5 rounded-full bg-brand text-white text-xs flex items-center justify-center flex-shrink-0 mt-0.5">3</span>
                <span>Show your QR codes to your partner</span>
              </li>
              <li class="flex items-start gap-2">
                <span class="w-5 h-5 rounded-full bg-brand text-white text-xs flex items-center justify-center flex-shrink-0 mt-0.5">4</span>
                <span>Scan their QR codes</span>
              </li>
            </ol>
          </div>
          <div>
            <h4 class="text-sm font-medium text-text-muted mb-2">Responder (Person B)</h4>
            <ol class="space-y-2 text-sm text-text-secondary">
              <li class="flex items-start gap-2">
                <span class="w-5 h-5 rounded-full bg-text-muted text-white text-xs flex items-center justify-center flex-shrink-0 mt-0.5">1</span>
                <span>Tap "Join Ceremony"</span>
              </li>
              <li class="flex items-start gap-2">
                <span class="w-5 h-5 rounded-full bg-text-muted text-white text-xs flex items-center justify-center flex-shrink-0 mt-0.5">2</span>
                <span>Enter the same passphrase</span>
              </li>
              <li class="flex items-start gap-2">
                <span class="w-5 h-5 rounded-full bg-text-muted text-white text-xs flex items-center justify-center flex-shrink-0 mt-0.5">3</span>
                <span>Scan the initiator's QR codes</span>
              </li>
              <li class="flex items-start gap-2">
                <span class="w-5 h-5 rounded-full bg-text-muted text-white text-xs flex items-center justify-center flex-shrink-0 mt-0.5">4</span>
                <span>Show your QR codes to them</span>
              </li>
            </ol>
          </div>
        </div>
        <p class="text-text-muted text-xs mt-4">
          The QR codes use fountain codes — you don't need to scan every single frame, just enough for the data to be assembled.
        </p>
      </div>

      <!-- Verify -->
      <div class="bg-bg-card border border-border rounded-xl p-6 mb-6">
        <h3 class="font-semibold mb-4">Step 3: Verify the Checksum</h3>
        <p class="text-text-secondary text-sm mb-4">
          Both phones will display the same 6-word phrase. <strong class="text-white">Read these words out loud to each other</strong> to confirm they match.
        </p>
        <div class="bg-bg-elevated rounded-lg p-4 text-center">
          <p class="text-text-muted text-xs mb-2">Example checksum:</p>
          <p class="text-lg font-mono text-white">alpine forest river sunset mountain breeze</p>
        </div>
        <p class="text-text-muted text-xs mt-4">
          If the words don't match, something went wrong — start over. Don't skip this step.
        </p>
      </div>

      <!-- Success -->
      <div class="bg-success/10 border border-success/30 rounded-xl p-6">
        <h4 class="text-success font-semibold mb-2 flex items-center gap-2">
          <svg class="w-5 h-5" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2">
            <path stroke-linecap="round" stroke-linejoin="round" d="M9 12.75L11.25 15 15 9.75M21 12a9 9 0 11-18 0 9 9 0 0118 0z" />
          </svg>
          You're Connected
        </h4>
        <p class="text-text-secondary text-sm">
          Once the checksums match, you're done! You now have a mathematically unbreakable channel with your contact. You can leave and communicate securely from anywhere.
        </p>
      </div>
    </section>

    <!-- Sending Messages -->
    <section id="sending-messages" class="mb-16 scroll-mt-24">
      <h2 class="text-2xl font-bold mb-4 pb-2 border-b border-border">3. Sending Messages</h2>

      <p class="text-text-secondary mb-6">
        After the ceremony, messaging works like any other app — type and send. Behind the scenes, everything is encrypted with your One-Time Pad.
      </p>

      <div class="grid md:grid-cols-2 gap-6 mb-6">
        <div class="bg-bg-card border border-border rounded-xl p-6">
          <h3 class="font-semibold mb-4">Text Messages</h3>
          <p class="text-text-secondary text-sm mb-4">
            Type your message and tap send. Messages are encrypted instantly on your device before being transmitted.
          </p>
          <ul class="space-y-2 text-sm text-text-muted">
            <li class="flex items-center gap-2">
              <svg class="w-4 h-4 text-success" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2"><path stroke-linecap="round" stroke-linejoin="round" d="M5 13l4 4L19 7" /></svg>
              End-to-end encrypted
            </li>
            <li class="flex items-center gap-2">
              <svg class="w-4 h-4 text-success" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2"><path stroke-linecap="round" stroke-linejoin="round" d="M5 13l4 4L19 7" /></svg>
              Mathematically unforgeable
            </li>
            <li class="flex items-center gap-2">
              <svg class="w-4 h-4 text-success" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2"><path stroke-linecap="round" stroke-linejoin="round" d="M5 13l4 4L19 7" /></svg>
              Forward-secure (key bytes destroyed after use)
            </li>
          </ul>
        </div>

        <div class="bg-bg-card border border-border rounded-xl p-6">
          <h3 class="font-semibold mb-4">Location Sharing</h3>
          <p class="text-text-secondary text-sm mb-4">
            Tap the location icon to send your current position. This is a one-shot share — not continuous tracking.
          </p>
          <ul class="space-y-2 text-sm text-text-muted">
            <li class="flex items-center gap-2">
              <svg class="w-4 h-4 text-success" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2"><path stroke-linecap="round" stroke-linejoin="round" d="M5 13l4 4L19 7" /></svg>
              Single moment in time
            </li>
            <li class="flex items-center gap-2">
              <svg class="w-4 h-4 text-success" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2"><path stroke-linecap="round" stroke-linejoin="round" d="M5 13l4 4L19 7" /></svg>
              ~10cm precision
            </li>
            <li class="flex items-center gap-2">
              <svg class="w-4 h-4 text-success" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2"><path stroke-linecap="round" stroke-linejoin="round" d="M5 13l4 4L19 7" /></svg>
              Same encryption as text
            </li>
          </ul>
        </div>
      </div>

      <!-- Pad Status -->
      <div class="bg-bg-card border border-border rounded-xl p-6">
        <h3 class="font-semibold mb-4">Watching Your Pad</h3>
        <p class="text-text-secondary text-sm mb-4">
          Each message uses a small amount of your encryption key (the "pad"). The app shows how much is remaining.
        </p>
        <div class="bg-bg-elevated rounded-lg p-4 mb-4">
          <div class="flex items-center justify-between mb-2">
            <span class="text-sm text-text-muted">Pad remaining</span>
            <span class="text-sm font-mono text-white">187 KB / 256 KB</span>
          </div>
          <div class="w-full bg-bg-card rounded-full h-2">
            <div class="bg-brand rounded-full h-2" style="width: 73%"></div>
          </div>
        </div>
        <p class="text-text-muted text-xs">
          When the pad runs out, you'll need to meet again to create a new one. Plan accordingly for important ongoing communication.
        </p>
      </div>
    </section>

    <!-- Burning -->
    <section id="burning" class="mb-16 scroll-mt-24">
      <h2 class="text-2xl font-bold mb-4 pb-2 border-b border-border">4. Burning Conversations</h2>

      <p class="text-text-secondary mb-6">
        When you're done communicating, "burning" a conversation permanently destroys all key material, making it impossible to decrypt messages — even for you.
      </p>

      <div class="bg-danger/10 border border-danger/30 rounded-xl p-6 mb-6">
        <h4 class="text-danger font-semibold mb-2 flex items-center gap-2">
          <svg class="w-5 h-5" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2">
            <path stroke-linecap="round" stroke-linejoin="round" d="M15.362 5.214A8.252 8.252 0 0112 21 8.25 8.25 0 016.038 7.048 8.287 8.287 0 009 9.6a8.983 8.983 0 013.361-6.867 8.21 8.21 0 003 2.48z" />
            <path stroke-linecap="round" stroke-linejoin="round" d="M12 18a3.75 3.75 0 00.495-7.467 5.99 5.99 0 00-1.925 3.546 5.974 5.974 0 01-2.133-1A3.75 3.75 0 0012 18z" />
          </svg>
          This Is Permanent
        </h4>
        <p class="text-text-secondary text-sm">
          Once you burn a conversation, it cannot be recovered. Not by you, not by your contact, not by us, not by anyone. The encryption key is destroyed and the math doesn't allow recovery.
        </p>
      </div>

      <div class="bg-bg-card border border-border rounded-xl p-6 mb-6">
        <h3 class="font-semibold mb-4">How to Burn</h3>
        <ol class="space-y-3">
          <li class="flex items-start gap-3">
            <span class="w-6 h-6 rounded-full bg-danger text-white text-sm flex items-center justify-center flex-shrink-0">1</span>
            <div>
              <span class="text-text-secondary">Open the conversation you want to destroy</span>
            </div>
          </li>
          <li class="flex items-start gap-3">
            <span class="w-6 h-6 rounded-full bg-danger text-white text-sm flex items-center justify-center flex-shrink-0">2</span>
            <div>
              <span class="text-text-secondary">Tap the menu icon and select "Burn Conversation"</span>
            </div>
          </li>
          <li class="flex items-start gap-3">
            <span class="w-6 h-6 rounded-full bg-danger text-white text-sm flex items-center justify-center flex-shrink-0">3</span>
            <div>
              <span class="text-text-secondary">Confirm when prompted — this cannot be undone</span>
            </div>
          </li>
        </ol>
      </div>

      <div class="bg-bg-card border border-border rounded-xl p-6">
        <h3 class="font-semibold mb-4">When to Burn</h3>
        <ul class="space-y-2 text-sm text-text-secondary">
          <li class="flex items-start gap-2">
            <svg class="w-4 h-4 text-brand mt-0.5" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2"><path stroke-linecap="round" stroke-linejoin="round" d="M5 13l4 4L19 7" /></svg>
            <span>When you've finished the conversation and don't need to communicate further</span>
          </li>
          <li class="flex items-start gap-2">
            <svg class="w-4 h-4 text-brand mt-0.5" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2"><path stroke-linecap="round" stroke-linejoin="round" d="M5 13l4 4L19 7" /></svg>
            <span>When you want to ensure no one can ever compel you to decrypt the messages</span>
          </li>
          <li class="flex items-start gap-2">
            <svg class="w-4 h-4 text-brand mt-0.5" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2"><path stroke-linecap="round" stroke-linejoin="round" d="M5 13l4 4L19 7" /></svg>
            <span>Before crossing a border or entering a situation where your device might be searched</span>
          </li>
          <li class="flex items-start gap-2">
            <svg class="w-4 h-4 text-brand mt-0.5" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2"><path stroke-linecap="round" stroke-linejoin="round" d="M5 13l4 4L19 7" /></svg>
            <span>When the pad is exhausted and you want to start fresh</span>
          </li>
        </ul>
      </div>
    </section>

    <!-- Troubleshooting -->
    <section class="mb-16">
      <h2 class="text-2xl font-bold mb-4 pb-2 border-b border-border">Common Issues</h2>

      <div class="space-y-4">
        <details class="bg-bg-card border border-border rounded-xl overflow-hidden group">
          <summary class="p-5 cursor-pointer font-medium flex items-center justify-between">
            QR codes aren't scanning
            <svg class="w-5 h-5 text-text-muted group-open:rotate-180 transition-transform" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7"/></svg>
          </summary>
          <div class="px-5 pb-5 text-text-secondary text-sm border-t border-border pt-4">
            <ul class="list-disc list-inside space-y-2">
              <li>Make sure both screens are bright and clearly visible</li>
              <li>Hold the phones steady and about arm's length apart</li>
              <li>Ensure good lighting — not too bright, not too dark</li>
              <li>Clean your camera lens if it's smudged</li>
              <li>The QR codes are animated — you don't need to catch every frame</li>
            </ul>
          </div>
        </details>

        <details class="bg-bg-card border border-border rounded-xl overflow-hidden group">
          <summary class="p-5 cursor-pointer font-medium flex items-center justify-between">
            Checksums don't match
            <svg class="w-5 h-5 text-text-muted group-open:rotate-180 transition-transform" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7"/></svg>
          </summary>
          <div class="px-5 pb-5 text-text-secondary text-sm border-t border-border pt-4">
            <p class="mb-3">If the 6-word phrases don't match, the ceremony failed. This could mean:</p>
            <ul class="list-disc list-inside space-y-2">
              <li>You entered different passphrases — double-check and try again</li>
              <li>Data was corrupted during scanning — start over</li>
              <li>Someone might be attempting an attack — verify you're really with your intended contact</li>
            </ul>
            <p class="mt-3 text-text-muted">Never proceed with mismatched checksums. Start the ceremony over.</p>
          </div>
        </details>

        <details class="bg-bg-card border border-border rounded-xl overflow-hidden group">
          <summary class="p-5 cursor-pointer font-medium flex items-center justify-between">
            Messages aren't delivering
            <svg class="w-5 h-5 text-text-muted group-open:rotate-180 transition-transform" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7"/></svg>
          </summary>
          <div class="px-5 pb-5 text-text-secondary text-sm border-t border-border pt-4">
            <ul class="list-disc list-inside space-y-2">
              <li>Check your internet connection</li>
              <li>Make sure the other person's app is running</li>
              <li>Messages are stored briefly on our relay — they'll be delivered when the recipient comes online</li>
              <li>If the pad is exhausted, you can't send more messages until you meet again</li>
            </ul>
          </div>
        </details>

        <details class="bg-bg-card border border-border rounded-xl overflow-hidden group">
          <summary class="p-5 cursor-pointer font-medium flex items-center justify-between">
            I lost my phone
            <svg class="w-5 h-5 text-text-muted group-open:rotate-180 transition-transform" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7"/></svg>
          </summary>
          <div class="px-5 pb-5 text-text-secondary text-sm border-t border-border pt-4">
            <p class="mb-3">If you lose your phone:</p>
            <ul class="list-disc list-inside space-y-2">
              <li>Your encryption keys are gone — this is by design</li>
              <li>No one else can read your messages either (they'd need your keys)</li>
              <li>You'll need to meet your contact again to establish a new connection</li>
              <li>There's no account to recover, no backup to restore</li>
            </ul>
          </div>
        </details>
      </div>
    </section>

    <!-- Footer Links -->
    <div class="pt-8 border-t border-border">
      <p class="text-text-muted text-sm text-center">
        For security details, see <a href="/security" class="text-brand hover:text-brand-light">Security</a>. For technical specifications, see the <a href="/whitepaper" class="text-brand hover:text-brand-light">Whitepaper</a>.
      </p>
    </div>
  </div>
</Layout>

<style>
  details summary::-webkit-details-marker {
    display: none;
  }
</style>
